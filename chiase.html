<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chia sẻ - VIVU VIỆT NAM</title>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="chiase.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Script -->
 <script defer>
  function openModal() {
    document.getElementById('shareModal').style.display = 'block';
  }

  function closeModal() {
    document.getElementById('shareModal').style.display = 'none';
    document.getElementById('imagePreview').innerHTML = '';
    document.getElementById('imagePreview').classList.add('hidden');
  }

  function previewImage(event) {
    const file = event.target.files[0];
    const preview = document.getElementById('imagePreview');
    preview.innerHTML = '';
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.innerHTML = `<img src="${e.target.result}" alt="preview">`;
        preview.classList.remove('hidden');
      };
      reader.readAsDataURL(file);
    }
  }

  // Tải các bài chia sẻ từ LocalStorage
  function loadPosts() {
    const postsContainer = document.getElementById('postsContainer');
    postsContainer.innerHTML = '';

    const savedPosts = JSON.parse(localStorage.getItem('vivuPosts') || '[]');
    savedPosts.reverse().forEach(postData => {
      const post = document.createElement('div');
      post.className = 'shared-post';

      if (postData.text) {
        const textElement = document.createElement('p');
        textElement.textContent = postData.text;
        post.appendChild(textElement);
      }

      if (postData.image) {
        const img = document.createElement('img');
        img.src = postData.image;
        img.alt = "Hình chia sẻ";
        img.style.maxWidth = '100%';
        img.style.marginTop = '12px';
        post.appendChild(img);
      }

      postsContainer.appendChild(post);
    });
  }

  // Khi DOM đã sẵn sàng
  document.addEventListener('DOMContentLoaded', function () {
    loadPosts();

    const form = document.getElementById('shareForm');
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const text = document.getElementById('shareText').value;
      const imageFile = document.getElementById('shareImage').files[0];

      if (!text && !imageFile) {
        alert('Vui lòng nhập nội dung hoặc tải ảnh.');
        return;
      }

      const newPost = { text: text, image: null };

      if (imageFile) {
        const reader = new FileReader();
        reader.onload = function(e) {
          newPost.image = e.target.result;

          saveAndRenderPost(newPost);
        };
        reader.readAsDataURL(imageFile);
      } else {
        saveAndRenderPost(newPost);
      }

      alert('Cảm ơn bạn đã chia sẻ!');
      closeModal();
      form.reset();
    });
  });

  function saveAndRenderPost(postData) {
    // Lưu vào localStorage
    const savedPosts = JSON.parse(localStorage.getItem('vivuPosts') || '[]');
    savedPosts.push(postData);
    localStorage.setItem('vivuPosts', JSON.stringify(savedPosts));

    // Cập nhật hiển thị
    loadPosts();
  }
</script>

</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <h1>VIVU VIỆT NAM</h1>
    <p class="tagline">Cổng thông tin & hỗ trợ du lịch Việt Nam toàn diện</p>

    <div class="search-bar">
      <i class="fas fa-search search-icon"></i>
      <input type="text" id="searchInput" placeholder="Tìm địa điểm..." onkeyup="searchDestinations()" />
    </div>
  </header>

  <!-- Nav -->
  <nav class="main-nav">
    <ul>
      <li><a href="index.html"><i class="fas fa-home"></i> Trang chủ</a></li>
      <li><a href="khampha.html"><i class="fas fa-map-marked-alt"></i> Khám phá</a></li>
      <li><a href="lichtrinh.html"><i class="fas fa-route"></i> Lên lịch trình</a></li>
      <li><a href="chiase.html" class="active"><i class="fas fa-comment-dots"></i> Chia sẻ</a></li>
      <li><a href="lehoi.html"><i class="fas fa-calendar-alt"></i> Lễ hội</a></li>
    </ul>
  </nav>

  <!-- Main -->
  <main>
    <div class="container">
      <section class="share-section">
        <h2>Chia sẻ trải nghiệm</h2>
        <p>Hãy cùng cộng đồng ViVu chia sẻ những hành trình, hình ảnh và câu chuyện du lịch đáng nhớ của bạn.</p>
                <button class="share-button" onclick="openModal()">
          <i class="fas fa-upload"></i> Chia sẻ ngay
        </button>
      </section>
      <section class="shared-posts">
  <h3>Bài chia sẻ gần đây</h3>
  <div id="postsContainer"></div>
</section>

    </div>

    <!-- Modal -->
<div id="shareModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h3><i class="fas fa-pen"></i> Chia sẻ hành trình của bạn</h3>

    <form id="shareForm">
      <div class="form-group">
        <label for="shareText">Nội dung</label>
        <textarea id="shareText" placeholder="Kể lại chuyến đi, cảm xúc của bạn..."></textarea>
      </div>

      <div class="form-group">
        <label for="shareImage">Ảnh kèm theo</label>
        <input type="file" id="shareImage" accept="image/*" onchange="previewImage(event)">
        <div id="imagePreview" class="image-preview hidden"></div>
      </div>

      <button type="submit"><i class="fas fa-paper-plane"></i> Đăng bài</button>
    </form>
  </div>
</div>

  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <p>&copy; 2025 VIVU VIỆT NAM. Giữ bản quyền nội dung.</p>
  </footer>
</body>
</html>
